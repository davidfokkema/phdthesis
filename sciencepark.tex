\chapter{The Amsterdam Science Park Array}
\label{ch:sciencepark}

\section{Introduction}

The \emph{Amsterdam Science Park Array} is a cluster of eight \hisparc stations
located on the roofs of several institutes and businesses.  One station is
located inside Nikhef and is prominently displayed in the main atrium.  The
largest distance inside the cluster is \SI{407}{\meter}. Each station has four
detectors. The stations are placed in the configuration shown in
\figref{fig:station-layout}. \figref{fig:sciencepark-layout} shows the locations
of the stations in the array.

\begin{figure}
\centering
\input{plots/sciencepark}
\caption{The Science Park Array. Each station has four detectors.
Individual detectors are represented by dots. The stations are placed in
the configuration shown in \figref{fig:station-layout}. The analysis
presented in this chapter is based on data taken with three stations (501,
503 and 506) which form an almost equilateral triangle with sides ranging
from \SIrange{122}{151}{\meter}.  The station at the University of
Amsterdam is located outside the figure.}
\label{fig:sciencepark-layout}
\end{figure}


\section{Coincidences}

The stations in the array have been configured to use the trigger conditions
discussed in \secref{sec:trigger}:
\begin{itemize}
    \item low trigger threshold at \SI{-30}{\milli\volt} (requiring \emph{three}
    detectors over threshold)
    \item high trigger threshold at \SI{-70}{\milli\volt} (requiring \emph{two}
    detectors over threshold)
\end{itemize}
Either condition, when satisfied, will result in a trigger. The high threshold
corresponds to approximately \SI{.5}{\mip}.
The stations have a trigger rate of \SIrange{.6}{.8}{\hertz}. All recorded events are sent to
the datastore at Nikhef.

From \figref{fig:ldf-threshold} it follows that extensive air showers with
energies of \SI{10}{\peta\electronvolt} or more have a sufficient footprint to
be observed by stations with a separation distance of the order of
\SI{100}{\meter}.
Searching for these \emph{coincidences} is based on the event timestamps
generated by the GPS timing modules.  The time difference resulting from a
horizontal shower in the direction of the largest distance in the cluster is
given by $\Delta t = s / c = \SI{407}{\meter} / c = \SI{1.36}{\micro\second}$.
Events are considered part of a coincidence if their time difference is
less than \SI{1.36}{\micro\second}.

The cosmic ray spectrum is a power law of the primary energy
(\figref{fig:energy_spectrum}), and the footprint of EAS is a function of this
energy. Therefore, the number of EAS of given size (or energy) observed by a
pair of stations is a function of the distance between the stations.
The cosmic ray flux decreases with energy, so EAS with small footprints are more
abundant than EAS with large footprints.  Thus, more coincidences should be
observed for pairs of stations which are in the vicinity of each other.
\figref{fig:number-of-coincidences} shows the number of coincidences for all
pairs of stations in the array.  The expected number of coincidences (depicted
as the solid line in the figure) is calculated as follows. First, the flux of
EAS is approximated by $F = E^{-2.7}$, with $E$ the energy of the primary
particle. Then, particle densities for a range of core distances are estimated
using a lateral distribution function, given in \cite{latpaper:2005}. The
detection probability is finally estimated using Poisson statistics. The
probability of detection is then weighted with the flux, resulting in an
estimate summed over all energies.

\begin{figure}
\centering
\input{plots/SP-DIR-artistplot_N_vs_R}
\caption{The number of coincidences between pairs of stations as a function of
their separation distance.  The solid line is an estimate for the number of
coincidences, summed over all energies. The cosmic ray flux decreases with
energy, so EAS with small footprints are more abundant than EAS with large
footprints.  This is reflected in the above results.  More coincidences are
observed when the distances are small, due to the many showers that are not
sufficient in size to trigger stations farther away.}
\label{fig:number-of-coincidences}
\end{figure}

There is no large background of random coincidences
obvious in \figref{fig:number-of-coincidences}.  The expected number of random
coincidences between two stations can be calculated using
\begin{equation}
N_r = 2 f_1\, f_2\, \tau\, T,
\end{equation}
with $f_1$ and $f_2$ the trigger rate of the two stations, $\tau$ the
coincidence time window and $T$ the duration of the measurement.  For a trigger
rate $f_1 = f_2 = \SI{.8}{\hertz}$, $\tau = \SI{1.36}{\micro\second}$ and $T =
\SI{1}{\day}$, we have $N_r = \num{0.15}$ random coincidences per pair of
stations for a day, which amounts to approximately 2 random coincidences per day
for the six stations (15 pairs) considered in this analysis.

The GPS locations of the stations have to be accurately determined.  Firstly,
the locations define the relative positions of all detectors in the analysis.
Secondly, inaccurate positions inhibit the ability of the GPS receiver to
accurately determine the current time.  All stations have performed an automatic
self-survey of \SI{1}{\day} (\num{86400} fixes).  The location of the stations
are listed in \tabref{tab:sciencepark-locations}.

\begin{table}
\centering
\begin{tabular}{
@{}
c
S[table-number-alignment=center, table-figures-integer=2, table-figures-decimal=6]
S[table-number-alignment=center, table-figures-integer=1, table-figures-decimal=6]
S[table-number-alignment=center, table-figures-integer=2, table-figures-decimal=1]
S[table-number-alignment=center, table-figures-integer=3, table-figures-decimal=0]
@{}}
\toprule
station & {latitude [\si{\degree}]} & {longitude [\si{\degree}]} &
{altitude [\si{\meter}]} & {orientation [\si{\degree}]} \\
\midrule
501 & 52.355924 & 4.951144 & 56.1 & 135 \\
502 & 52.355293 & 4.950105 & 56.0 & 345 \\
503 & 52.356255 & 4.952944 & 51.6 & 45 \\
504 & 52.357179 & 4.954384 & 54.6 & 175 \\
505 & 52.357252 & 4.948401 & 47.7 & 86 \\
506 & 52.357179 & 4.951986 & 43.9 & 267 \\
\bottomrule
\end{tabular}
\caption{GPS locations of the stations in the Amsterdam Science Park
Array.  These are the results of a self-survey of \num{86400} fixes during
a full day, given to \SI{10}{\centi\meter} accuracy. The orientation of a
station with respect to ``North'' is measured using a compass to an
accuracy of \SI{1}{\degree}.}
\label{tab:sciencepark-locations}
\end{table}

The accuracy of the GPS timing module has been discussed in
\secref{sec:gps-timing}.  Since there is an offset of tens of nanoseconds
between the GPS setups, a correction must be made.  First, the offset has to be
determined from the data.  Station 501 is chosen as a reference.  For each
station, the coincidences with station 501 are analyzed.  The differences of the
timestamps are the result of both the arrival time differences of particles in
the EAS, and the differences between the GPS modules.  Summed over a large
number of EAS, the distribution should be centered around zero, since the
arrival directions are isotropic.  The offset of the GPS modules, however,
causes an equal offset in the timestamps.
\figref{fig:station-timing-distribution} shows the distribution of time
differences between stations 501 and 502.  The GPS offset is measured to be
\SI{15}{\nano\second}.


\section{Reconstruction of Shower Direction}

The direction of an EAS is reconstructed using the same method and algorithm
discussed in \secref{sec:direction-reconstruction-method}.  This implies that
for each reconstruction, three measurements are used.  In the case of a cluster,
this means that three stations are used to reconstruct the direction of the
shower.

The analysis presented in this section is based on data taken from January 1,
2012 to April 1, 2012, with three stations (501, 503 and 506) which form an
approximately equilateral triangle with sides ranging from
\SIrange{122}{151}{\meter}.

First, the performance of the single stations is checked. EAS directions are
reconstructed using data from a single station only.
\figref{fig:single-stations-hists} shows the reconstructions of shower direction
for the stations 501, 503 and 506.  The azimuthal distribution is flat,
consistent with an isotropic distribution of the direction of EAS.
Deviations from the flat distribution can be explained by statistical
uncertainties in the distribution of arrival directions, and are not the result
of anisotropy.
The zenith distribution shows few showers with small zenith angles, and peaks
around \SI{20}{\degree}.  For larger zenith angles, the acceptance of the
detectors decreases.  Furthermore, since slanted showers traverse a larger
atmospheric depth, fewer particles reach the ground.  This reduces the
probability of detection. The difference in the number of events is due to
differences in PMT voltage settings. As a result of this, the trigger levels are
at different values relative to the \mip peak. We conclude that the stations
perform well.

\begin{figure}
\centering
{\pgfkeys{/artist/width/.initial=.35\linewidth}
\input{plots/SP-DIR-hist_fav_single_stations-phi}
\vspace{1cm}
\input{plots/SP-DIR-hist_fav_single_stations-theta}
}
\caption{Reconstruction of shower direction for single stations.  Results are
shown for stations 501, 503 and 506.  The azimuthal angle $\phi$ shows a
flat distribution, while the zenith angle $\theta$ shows a
distribution peaked around \SI{20}{\degree}.}
\label{fig:single-stations-hists}
\end{figure}

Coincidences of three or more stations are selected from the complete dataset.
Each event in the coincidence is analyzed using a three-step process to obtain
an accurate arrival time for the first particle in the station.
Firstly, the linear interpolation method (\textsmaller{LINT}), discussed in
\secref{sec:kascade-reconstruction}, is used to determine the arrival time of
particles in the detectors.  Secondly, the event timestamp is corrected so that it no longer
defines the moment in time that the trigger condition was met, but rather the
instant that the first particle was detected by the station.  Thirdly, the
timestamp is corrected for the GPS timing offset.  When a coincidence occurs
between four or more stations, multiple reconstructions are performed. All
unique combinations of three stations are reconstructed separately.

To investigate the accuracy of the reconstructions, the direction of EAS are
also reconstructed using the single stations, when possible.  The results of the
reconstructions can then be compared.  Stations 501, 503 and 506 form a triangle
with sides of \SIlist{122;128;151}{\meter}.  Reconstructions from this
subcluster are compared to reconstructions from the individual stations.

To verify that the single station reconstructions can be used as a reference,
EAS are selected which have been reconstructed by more than one station. Each
station is required to have at least two particles in all corner detectors
($N_\mathrm{\mip} \geq 2$).
\figref{fig:sciencepark-single-vs-single} shows the comparison of reconstructed
shower directions by single stations. The plots are laid out as a matrix. From
top to bottom, and from left to right, data is presented from stations 501, 503
and 506. Each datapoint represents an EAS which was reconstructed
by two stations, simultaneously. The three plots in the top right show a
comparison of the azimuthal direction $\phi$, whereas the bottom left plots show
a comparison of the zenith direction $\theta$. The reconstructions performed by
each pair of stations are in agreement.
\begin{figure}
\centering
{\pgfkeys{/artist/width/.initial=.35\linewidth}
\longprocess{\input{plots/SP-DIR-plot_fav_single_vs_single}}
}
\caption{Comparison of reconstructed shower directions by single stations,
using two-dimensional histograms. From top to bottom, and from left to
right, data is presented from stations 501, 503 and 506, respectively.
For example, the plot in the upper right corner shows EAS reconstructed by
stations 501 (vertical axis) and 506 (horizontal axis).  The three plots
in the top right show a comparison of the azimuthal direction $\phi$,
whereas the bottom left plots show a comparison of the zenith direction
$\theta$.  Each bin represents EAS which were reconstructed by two
stations simultaneously.  Each station is required to have at least two
particles in all corner detectors ($N_\mathrm{\mip} \geq 2$).  The
reconstructions performed by each pair of stations are in agreement.}
\label{fig:sciencepark-single-vs-single}
\end{figure}

\figref{fig:sciencepark-uncertainty-single-vs-single} shows the uncertainties in
the reconstructions. The plots are again laid out as a matrix. The uncertainties
are defined as the difference in angle which contains \SI{66}{\percent} of the
reconstructions, and are estimated using the equations developed in
\secref{sec:uncertainty-calculations}.  The uncertainty in the arrival time of a
single station reconstruction is taken to be \SI{2.4}{\nano\second}
(\secref{sec:kascade-reconstruction}).  The total uncertainty in the azimuthal
angle reconstruction is then given by the quadratic sum of the uncertainties for
a single station, i.e.:
\begin{equation}
\sigma_{\phi,\,\mathrm{total}} = \sqrt{\sigma_{\phi, j}^2 + \sigma_{\phi, k}^2},
\end{equation}
with $j, k$ indexes for the stations. Similar equations describe the
uncertainties in the zenith angles.
The reconstruction accuracy is shown as a function of the zenith angle.  The
three plots in the top right show the uncertainties of the azimuthal direction $\phi$, whereas the
bottom left plots show the uncertainties of the zenith direction $\theta$.
The points represent the experimental data.  The solid lines are estimates for
the uncertainties. Data and calculations agree for the azimuthal and zenith
angle reconstructions. Small differences in the accuracy of the stations can be seen
in the data. We conclude that the single station reconstructions in the Science
Park Array meet expectations and thus can be used as a reference.
\begin{figure}
\centering
{\pgfkeys{/artist/width/.initial=.35\linewidth}
\input{plots/SP-DIR-plot_fav_uncertainty_single_vs_single}
}
\caption{Uncertainties in the reconstruction of EAS simultaneously
performed by a pair of single stations.  Each station is required to have
at least two particles in all corner detectors ($N_\mathrm{\mip} \geq 2$).
From top to bottom, and from left to right, data is presented from
stations 501, 503 and 506, respectively. The uncertainties are defined as
the difference in angle which contains \SI{66}{\percent} of the
reconstructions.  The reconstruction accuracy is shown as a function of
the zenith angle.  The three plots in the top right show the uncertainties
of the azimuthal direction $\phi$, whereas the bottom left plots show the
uncertainties of the zenith direction $\theta$. The experimental data is
depicted by circles.  The solid lines show estimates for the uncertainties
obtained by propagating the experimental timing uncertainties through the
analysis.  The observed reconstruction differences are close to the
calculated estimates.}
\label{fig:sciencepark-uncertainty-single-vs-single}
\end{figure}

The direction reconstructions using single stations are compared to the
reconstructions using the subcluster.
Firstly, coincidences are selected containing stations 501, 503 and 506.
Secondly, only those events are selected for which the shower direction could be
reconstructed using the subcluster. No cut on the number of particles in the
detectors is imposed. Thirdly, for each station, a cut is made on the data to
contain only those coincidences which were also reconstructed by the single
station, and which contained at least two particles in the corner detectors
($N_\mathrm{\mip} \geq 2$). This cut is imposed on the single-station
reconstruction only, so the two other stations taking part in the coincidence
are allowed to have less particles in the detectors.
The resulting dataset now contains EAS which were simultaneously reconstructed
by the subcluster and a single station.

\figref{fig:sp-results-comparison} shows the azimuthal and zenith
reconstructions as scatter plots.  A clear correlation is visible.  However,
small systematic uncertainties of the reconstruction of individual stations are
visible.  These effects are most prominent for station 503 and 506.  This is
most likely the result of uncertainties in the position of the detectors.  In
\cite{Bosboom:2011} the observed effect is explained by simulating the results
for a slightly deformed station, where the reconstruction assumes a regular
station. The positions of the detectors of station 501 have been measured to
less than \SI{10}{\centi\meter} and it is found that the station deviates from
the ideal layout. Similar measurements need to be performed for all stations.

\begin{figure}
\centering
{\pgfkeys{/artist/width/.initial=.35\linewidth}
\longprocess{\input{plots/SP-DIR-plot_fav_single_vs_cluster-phi}}
\vspace{1cm}
\longprocess{\input{plots/SP-DIR-plot_fav_single_vs_cluster-theta}}
}
\caption{Reconstruction of EAS simultaneously performed using a subcluster
and a single station. Reconstructions from the single stations require
$N_\mathrm{\mip} \geq 2$. The subcluster contains the stations 501, 503
and 506.  The left, middle and right panel show the results of the
subcluster compared to the results of the single stations 501, 503 and
506, respectively.  Stations 503 and 506 show systematic errors in the
reconstruction, most obvious for the azimuthal angles.}
\label{fig:sp-results-comparison}
\end{figure}

The experimental uncertainties are determined by taking the differences of the
reconstructions and calculating the angle difference which contains
\SI{66}{\percent} of the events.
The uncertainties are estimated using the equations developed in
\secref{sec:uncertainty-calculations}.  The uncertainty in the arrival time of
the single station reconstruction is taken to be \SI{2.4}{\nano\second}, while
the uncertainty in the timing within a cluster is dominated by the GPS timing
accuracy (jitter) of approximately \SI{5}{\nano\second} \cite{trimble}.  The
arrival time uncertainty in for the cluster is given
$\sigma_{t,\,\mathrm{cluster}} = \sqrt{2.4^2 + 5^2} =
\SI{5.5}{\nano\second}$. The total uncertainty in the azimuthal angle
reconstruction is given by
\begin{equation}
\sigma_\phi = \sqrt{\sigma_{\phi, \mathrm{detector}}^2 + \sigma_{\phi,
\mathrm{cluster}}^2},
\end{equation}
and similarly for the zenith angles. The contributions must be
calculated separately since both the single station reconstruction and cluster
reconstruction have uncertainties which depend on the geometry of the detectors
or stations used in the reconstruction.
The calculations are performed using \eqtworef{eq:errphi}{eq:errtheta}.

As a function of the zenith angle, the reconstruction uncertainties are shown in
\figref{fig:sp-results-uncertainties}. The uncertainties
deviate from the expected value by approximately \SI{10}{\percent}. This can be
understood as an additional experimental uncertainty either of the station, the
cluster, or both. This uncertainty is very small, however, and may well be
understood by further study of the GPS offsets, the positions of the detectors
within the stations, and the orientation of the station.

\begin{figure}
\centering
{\pgfkeys{/artist/width/.initial=.35\linewidth}
\input{plots/SP-DIR-plot_fav_uncertainty_single_vs_cluster}
}
\caption{Uncertainties in the reconstruction of EAS simultaneously
performed using a cluster and a single station.  The cluster contains the
stations 501, 503 and 506.  Reconstructions from the single stations
require $N_\mathrm{\mip} \geq 2$.  The uncertainties are defined as the
difference in angle which contains \SI{66}{\percent} of the
reconstructions.  The results are shown as a function of the zenith angle.
The experimental data is depicted by circles.  The solid lines show
estimates for the uncertainties obtained by propagating the experimental
timing uncertainties through the analysis.  The observed reconstruction
differences are close to the calculated estimates.}
\label{fig:sp-results-uncertainties}
\end{figure}


\section{Discussion and Conclusions}

The reconstruction of the direction of a shower by different stations in a
cluster has been presented. Without an external reference for the shower
direction, the reconstructions from single stations have been compared to the
reconstruction of a subcluster of three stations. First, the performance of the
single stations was investigated. The distribution of arrival directions of
cosmic rays is assumed to be isotropic.
This is reflected in the azimuthal directions, as reconstructed by the single
stations (\figref{fig:single-stations-hists}). The data show a flat distribution
in $\phi$. The distribution of the zenith angle is more complicated. First, for
a given zenith angle $\theta$, the area on the celestial sphere which is
observed is proportional to $\sin\theta$.
However, the acceptance of the detectors is proportional to $\cos\theta$.
Furthermore, inclined showers traverse more atmosphere and the probability of
detection further decreases with larger zenith angles. The exact relationship
has not been investigated in this analysis, but the measured distributions
conform to expectations \cite{Grupen:2005}.

The performance of the stations is further investigated by comparing the
direction of EAS which have been simultaneously reconstructed by more than one
station. The uncertainties in the reconstruction agree with
expectations (\figref{fig:sciencepark-uncertainty-single-vs-single}). The single
stations can be used as a reference (with the stated uncertainties) for
reconstructing the direction of EAS using a subcluster of three stations.

Direction reconstructions performed by the subcluster of stations 501, 503 and
506 are compared to the reconstructions of the single stations, whenever such
information is availabe (\figref{fig:sp-results-uncertainties}). The comparison
shows small systematic uncertainties which are visible in the comparison with
stations 503 and 506. The experimentally determined uncertainties are
approximately \SI{10}{\percent} larger than the calculated values. The
uncertainty in the arrival time measurements has a standard deviation $\sigma =
\SI{5.5}{\nano\second}$. This is a very nice result. By further study of the GPS
offsets, the positions of the detectors within the stations, and the orientation
of the station, the systematic uncertainties may be understood. Also,
simulations using unthinned \SI{10}{\peta\electronvolt} showers may be
performed.

Since the reconstruction uncertainty (\eqtworef{eq:errphi}{eq:errtheta}) is
inversely proportional to the distance between detectors (or stations), the
uncertainty in the results is dominated by the single station contribution. The
distance between the stations 501, 503 and 506 is of the order of
\SI{130}{\meter}, which is more than ten times the distance between detectors.
Calculation of the precision of the shower direction observed by the subcluster
of 501, 503 and 506, yields $\sigma_\phi = \SI{2.7}{\degree}$ and $\sigma_\theta
= \SI{1.1}{\degree}$ for $\theta = \SI{22.5}{\degree}$ and $N_\mathrm{MIP} \geq
2$. Expressed as an angular distance (\secref{sec:reconstruction-conclusions}),
the accuracy then becomes \SI{1.5}{\degree}.
